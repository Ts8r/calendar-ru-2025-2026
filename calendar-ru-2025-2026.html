<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ö–∞–ª–µ–Ω–¥–∞—Ä—å 2025‚Äì2026 (–ø—Ä–æ—Å—Ç–æ–π) + —ç–∫—Å–ø–æ—Ä—Ç –≤ Word</title>
<!-- Librairie DOCX (CDN). Besoin d'internet pour la charger. -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.3.2/docx.umd.min.js" defer></script>
<style>
  :root { --border:#1f2937; --muted:#6b7280; --accent:#2563eb; }
  * { box-sizing: border-box; }
  body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans", sans-serif; margin: 24px; color:#111; }
  h1 { margin: 0 0 10px 0; font-size: 1.8rem; }
  .controls { margin: 8px 0 16px 0; }
  .controls button { padding: 8px 12px; border:1px solid var(--border); background:#f3f4f6; cursor:pointer; border-radius:8px; }
  .year { margin-top: 28px; page-break-inside: avoid; }
  .year > h2 { margin:0 0 8px 0; font-size:1.4rem; }
  .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
  .month { border:1px solid var(--border); border-radius: 10px; overflow: hidden; }
  .month h3 { margin: 0; padding: 8px 10px; background:#f3f4f6; font-size: 1rem; text-align: center; border-bottom:1px solid var(--border); }
  table { width: 100%; border-collapse: collapse; table-layout: fixed; }
  th, td { border: 1px solid var(--border); text-align: center; vertical-align: top; padding: 6px 4px; height: 64px; }
  thead th { background: #fafafa; font-weight: 600; padding: 6px 2px; height: auto; }
  .num { font-weight: 600; font-size: 0.95rem; }
  .muted { color: var(--muted); }
  .today { outline: 2px solid var(--accent); outline-offset: -2px; background: #eef2ff; }
  @media print {
    body { margin: 0.7cm; }
    .grid { gap: 10px; }
    th, td { height: 56px; padding: 4px 3px; }
    .month { break-inside: avoid; }
    .pagebreak { page-break-before: always; }
    .controls { display: none; }
  }
</style>
</head>
<body>
  <h1>–ö–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ 2025 –∏ 2026 –≥–æ–¥—ã</h1>
  <div class="controls">
    <button id="downloadWord" type="button">üì• –°–∫–∞—á–∞—Ç—å –¥–ª—è Word</button>
  </div>

  <section id="year-2025" class="year" aria-label="–ö–∞–ª–µ–Ω–¥–∞—Ä—å 2025 –≥–æ–¥–∞">
    <h2>2025 –≥–æ–¥</h2>
    <div class="grid" id="grid-2025"></div>
  </section>

  <section id="year-2026" class="year pagebreak" aria-label="–ö–∞–ª–µ–Ω–¥–∞—Ä—å 2026 –≥–æ–¥–∞">
    <h2>2026 –≥–æ–¥</h2>
    <div class="grid" id="grid-2026"></div>
  </section>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const MONTHS = ["–Ø–Ω–≤–∞—Ä—å","–§–µ–≤—Ä–∞–ª—å","–ú–∞—Ä—Ç","–ê–ø—Ä–µ–ª—å","–ú–∞–π","–ò—é–Ω—å","–ò—é–ª—å","–ê–≤–≥—É—Å—Ç","–°–µ–Ω—Ç—è–±—Ä—å","–û–∫—Ç—è–±—Ä—å","–ù–æ—è–±—Ä—å","–î–µ–∫–∞–±—Ä—å"];
  const DOW    = ["–ü–Ω","–í—Ç","–°—Ä","–ß—Ç","–ü—Ç","–°–±","–í—Å"];
  const today  = new Date();

  function daysInMonth(y, m){ return new Date(y, m+1, 0).getDate(); }
  function mondayIndex(jsDay){ return (jsDay + 6) % 7; }

  function buildMonthTable(year, monthIndex) {
    const wrapper = document.createElement('div');
    wrapper.className = 'month';

    const title = document.createElement('h3');
    title.textContent = MONTHS[monthIndex];
    wrapper.appendChild(title);

    const table = document.createElement('table');
    const thead = document.createElement('thead');
    const trh = document.createElement('tr');
    DOW.forEach(lbl => {
      const th = document.createElement('th'); th.scope = "col"; th.textContent = lbl; trh.appendChild(th);
    });
    thead.appendChild(trh); table.appendChild(thead);

    const tbody = document.createElement('tbody');

    const first = new Date(year, monthIndex, 1);
    const firstOffset = mondayIndex(first.getDay());
    const dim = daysInMonth(year, monthIndex);
    const prevDim = daysInMonth(year, monthIndex - 1);

    let day = 1, nextDay = 1;

    for (let week = 0; week < 6; week++) {
      const tr = document.createElement('tr');
      for (let dow = 0; dow < 7; dow++) {
        const td = document.createElement('td');
        const index = week * 7 + dow;
        let display, isCurrent = true, cellDate;

        if (index < firstOffset) {
          display = prevDim - (firstOffset - 1 - index);
          isCurrent = false; cellDate = new Date(year, monthIndex - 1, display);
        } else if (day <= dim) {
          display = day++;  cellDate = new Date(year, monthIndex, display);
        } else {
          display = nextDay++; isCurrent = false; cellDate = new Date(year, monthIndex + 1, display);
        }

        const num = document.createElement('div');
        num.className = 'num' + (isCurrent ? '' : ' muted');
        num.textContent = display;
        td.appendChild(num);

        const isToday = isCurrent &&
          cellDate.getFullYear() === today.getFullYear() &&
          cellDate.getMonth() === today.getMonth() &&
          cellDate.getDate() === today.getDate();
        if (isToday) td.classList.add('today');

        tr.appendChild(td);
      }
      tbody.appendChild(tr);
      if (week >= 4) {
        const hasCurrent = Array.from(tr.children).some(td => !td.firstChild.className.includes('muted'));
        if (!hasCurrent) { tbody.removeChild(tr); break; }
      }
    }

    table.appendChild(tbody);
    wrapper.appendChild(table);
    return wrapper;
  }

  function renderYear(year, containerId) {
    const grid = document.getElementById(containerId);
    for (let m = 0; m < 12; m++) grid.appendChild(buildMonthTable(year, m));
  }

  renderYear(2025, 'grid-2025');
  renderYear(2026, 'grid-2026');

  // --- Bouton T√©l√©charger DOCX ---
  const btn = document.getElementById('downloadWord');
  btn.addEventListener('click', async (e) => {
    e.preventDefault();
    try {
      if (!window.docx) {
        alert("La librairie docx n'est pas charg√©e.\nV√©rifie ta connexion Internet ou les bloqueurs.");
        return;
      }
      const { Document, Packer, Paragraph, Table, TableRow, TableCell, WidthType, HeadingLevel } = window.docx;

      const doc = new Document({ sections: [] });

      [2025, 2026].forEach((year) => {
        const children = [ new Paragraph({ text: `${year} –≥–æ–¥`, heading: HeadingLevel.HEADING_1 }) ];

        for (let m = 0; m < 12; m++) {
          children.push(new Paragraph({ text: MONTHS[m], heading: HeadingLevel.HEADING_2 }));

          const headerRow = new TableRow({
            children: ["–ü–Ω","–í—Ç","–°—Ä","–ß—Ç","–ü—Ç","–°–±","–í—Å"].map(lbl =>
              new TableCell({ width: { size: 100/7, type: WidthType.PERCENTAGE }, children: [ new Paragraph(lbl) ] })
            )
          });

          const rows = [headerRow];

          const first = new Date(year, m, 1);
          const offset = mondayIndex(first.getDay());
          const dim = daysInMonth(year, m);
          let day = 1;

          for (let w = 0; w < 6; w++) {
            const cells = [];
            for (let d = 0; d < 7; d++) {
              const idx = w * 7 + d;
              let display = "";
              if (idx >= offset && day <= dim) display = String(day++);
              cells.push(new TableCell({ children: [ new Paragraph(display) ] }));
            }
            rows.push(new TableRow({ children: cells }));
            if (day > dim) break;
          }

          children.push(new Table({ rows }));
        }

        doc.addSection({ children });
      });

      const blob = await Packer.toBlob(doc);
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = "–ö–∞–ª–µ–Ω–¥–∞—Ä—å-2025-2026-–ø—Ä–æ—Å—Ç–æ–π.docx";
      document.body.appendChild(a);
      a.click();
      a.remove();
      setTimeout(() => URL.revokeObjectURL(a.href), 1000);
    } catch (err) {
      console.error(err);
      alert("Erreur pendant la g√©n√©ration du fichier Word. Regarde la console pour le d√©tail.");
    }
  });
});
</script>
</body>
</html>
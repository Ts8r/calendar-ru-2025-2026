<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ö–∞–ª–µ–Ω–¥–∞—Ä—å 2025‚Äì2026</title>
<!-- Librairie DOCX pour l‚Äôexport Word (CDN, marche en ligne) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.3.2/docx.umd.min.js" defer></script>
<style>
  :root { --border:#1f2937; --muted:#6b7280; --accent:#2563eb; }
  * { box-sizing: border-box; }
  body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans", sans-serif; margin: 24px; color:#111; }
  h1 { margin: 0 0 10px 0; font-size: 1.8rem; }
  .controls { margin: 8px 0 16px 0; }
  .controls button { padding: 8px 12px; border:1px solid var(--border); background:#f3f4f6; cursor:pointer; border-radius:8px; }
  .year { margin-top: 28px; page-break-inside: avoid; }
  .year > h2 { margin:0 0 8px 0; font-size:1.4rem; }
  .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
  .month { border:1px solid var(--border); border-radius: 10px; overflow: hidden; background:#fff; }
  .month h3 { margin: 0; padding: 8px 10px; background:#f3f4f6; font-size: 1rem; text-align: center; border-bottom:1px solid var(--border); }
  table { width: 100%; border-collapse: collapse; table-layout: fixed; }
  th, td { border: 1px solid var(--border); text-align: center; vertical-align: top; padding: 6px 4px; height: 64px; }
  thead th { background: #fafafa; font-weight: 600; }
  .num { font-weight: 600; font-size: 0.95rem; }
  .muted { color: var(--muted); }
  .today { outline: 2px solid var(--accent); outline-offset: -2px; background: #eef6ff; }
  @media print { body{margin:0.7cm} .controls{display:none} .grid{gap:10px} th,td{height:56px;padding:4px 3px} .month{break-inside:avoid} }
</style>
</head>
<body>
  <h1>–ö–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ 2025 –∏ 2026 –≥–æ–¥—ã</h1>
  <div class="controls">
    <button id="downloadWord" type="button">üì• –°–∫–∞—á–∞—Ç—å –¥–ª—è Word</button>
  </div>

  <section class="year" aria-label="–ö–∞–ª–µ–Ω–¥–∞—Ä—å 2025 –≥–æ–¥–∞">
    <h2>2025 –≥–æ–¥</h2>
    <div class="grid" id="grid-2025"></div>
  </section>

  <section class="year" aria-label="–ö–∞–ª–µ–Ω–¥–∞—Ä—å 2026 –≥–æ–¥–∞">
    <h2>2026 –≥–æ–¥</h2>
    <div class="grid" id="grid-2026"></div>
  </section>

  <footer style="margin-top:12px;color:#374151;font-size:.93rem">
    –ù–µ–¥–µ–ª—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞. –¢–∞–±–ª–∏—Ü—É –º–æ–∂–Ω–æ —Ä–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å –∏–ª–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ Word. –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞—ë—Ç .docx.
  </footer>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const MONTHS = ["–Ø–Ω–≤–∞—Ä—å","–§–µ–≤—Ä–∞–ª—å","–ú–∞—Ä—Ç","–ê–ø—Ä–µ–ª—å","–ú–∞–π","–ò—é–Ω—å","–ò—é–ª—å","–ê–≤–≥—É—Å—Ç","–°–µ–Ω—Ç—è–±—Ä—å","–û–∫—Ç—è–±—Ä—å","–ù–æ—è–±—Ä—å","–î–µ–∫–∞–±—Ä—å"];
  const DOW    = ["–ü–Ω","–í—Ç","–°—Ä","–ß—Ç","–ü—Ç","–°–±","–í—Å"];
  const today  = new Date();

  const daysInMonth = (y,m)=> new Date(y,m+1,0).getDate();
  const mondayIndex = (jsDay)=> (jsDay+6)%7; // 0=Sun..6=Sat -> 0=Mon..6=Sun

  function buildMonthTable(year, monthIndex){
    const wrap=document.createElement("div");
    wrap.className="month";
    const h=document.createElement("h3"); h.textContent=MONTHS[monthIndex]; wrap.appendChild(h);

    const tbl=document.createElement("table");
    const thead=document.createElement("thead");
    const trh=document.createElement("tr");
    DOW.forEach(lbl=>{ const th=document.createElement("th"); th.textContent=lbl; trh.appendChild(th); });
    thead.appendChild(trh); tbl.appendChild(thead);

    const tbody=document.createElement("tbody");
    const first=new Date(year,monthIndex,1);
    const offset=mondayIndex(first.getDay());
    const dim=daysInMonth(year,monthIndex);
    const prevDim=daysInMonth(year,monthIndex-1);
    let day=1, next=1;

    for(let w=0;w<6;w++){
      const tr=document.createElement("tr");
      for(let d=0;d<7;d++){
        const td=document.createElement("td");
        const idx=w*7+d;
        let display, isCurr=true, cellDate;

        if(idx<offset){ display=prevDim-(offset-1-idx); isCurr=false; cellDate=new Date(year,monthIndex-1,display); }
        else if(day<=dim){ display=day++; cellDate=new Date(year,monthIndex,display); }
        else { display=next++; isCurr=false; cellDate=new Date(year,monthIndex+1,display); }

        const num=document.createElement("div");
        num.className="num"+(isCurr?"":" muted");
        num.textContent=display;
        td.appendChild(num);

        const isToday=isCurr && cellDate.getFullYear()===today.getFullYear() && cellDate.getMonth()===today.getMonth() && cellDate.getDate()===today.getDate();
        if(isToday) td.classList.add("today");

        tr.appendChild(td);
      }
      tbody.appendChild(tr);
      if(w>=4){
        const hasCurrent=Array.from(tr.children).some(td=>!td.firstChild.className.includes("muted"));
        if(!hasCurrent){ tbody.removeChild(tr); break; }
      }
    }
    tbl.appendChild(tbody);
    wrap.appendChild(tbl);
    return wrap;
  }

  function renderYear(year, containerId){
    const grid=document.getElementById(containerId);
    for(let m=0;m<12;m++) grid.appendChild(buildMonthTable(year,m));
  }

  renderYear(2025,"grid-2025");
  renderYear(2026,"grid-2026");

  // ---- Export Word ----
  document.getElementById("downloadWord").addEventListener("click", async () => {
    if(!window.docx){ alert("La librairie docx n'est pas charg√©e."); return; }
    const { Document, Packer, Paragraph, Table, TableRow, TableCell, WidthType, HeadingLevel } = window.docx;

    const doc=new Document({ sections: [] });

    [2025,2026].forEach(year=>{
      const children=[ new Paragraph({ text: `${year} –≥–æ–¥`, heading: HeadingLevel.HEADING_1 }) ];
      for(let m=0;m<12;m++){
        children.push(new Paragraph({ text: MONTHS[m], heading: HeadingLevel.HEADING_2 }));
        const headerRow=new TableRow({
          children: DOW.map(lbl=> new TableCell({ width:{size:100/7,type:WidthType.PERCENTAGE}, children:[ new Paragraph(lbl) ] }))
        });
        const rows=[headerRow];

        const first=new Date(year,m,1);
        const offset=mondayIndex(first.getDay());
        const dim=daysInMonth(year,m);
        let day=1;

        for(let w=0;w<6;w++){
          const cells=[];
          for(let d=0;d<7;d++){
            const idx=w*7+d;
            const txt=(idx>=offset && day<=dim)? String(day++) : "";
            cells.push(new TableCell({ children:[ new Paragraph(txt) ] }));
          }
          rows.push(new TableRow({ children: cells }));
          if(day>dim) break;
        }
        children.push(new Table({ rows }));
      }
      doc.addSection({ children });
    });

    const blob=await Packer.toBlob(doc);
    const a=document.createElement("a");
    a.href=URL.createObjectURL(blob);
    a.download="–ö–∞–ª–µ–Ω–¥–∞—Ä—å-2025-2026.docx";
    document.body.appendChild(a);
    a.click();
    a.remove();
    setTimeout(()=>URL.revokeObjectURL(a.href),1000);
  });
});
</script>
</body>
</html>
